<!DOCTYPE html>
<html style="height: 100%">
<head>
    <meta charset="utf-8">
</head>
<body style="height: 100%; margin: 0">
<div id="container" style="height: 100%"></div>
<script type="text/javascript" src="js/echarts.js"></script>
<script type="text/javascript">
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);
    var app = {};
    option = null;
    //顶部个数
    var yearCount = 11;
    //底部个数
    var categoryCount = 6;
    //所有底部名字
    var xAxisData = [];
    //图红色线条
    var customData = [];
    //所有顶部名字
    var legendData = [];
    //数量
    var dataList = [];

    legendData.push('价格趋势');
    //红色线条
    var encodeY = [];
    for (var i = 0; i < yearCount; i++) {
        legendData.push((2010 + i) + '');
        //下面每一个数据
        dataList.push([]);
        encodeY.push(1 + i);
    }

    //添加底部数据
    xAxisData.push("操作系统1111111111aaaaaaaaa1");
    xAxisData.push("数据库1111111111aaaaaaaaaaa111111");
    xAxisData.push("安全软件11111111aaaaaaaaa111111111");
    xAxisData.push("管理软件1111111aaaaaaaaaaa111111111");
    xAxisData.push("办公软件1111111aaaaaaaaaa111111111");
    xAxisData.push("行业软件111111aaaaaaaaaaa1111111111");

    for (var i = 0; i < categoryCount; i++) {
        //红色线条
        var customVal = [i];
        customData.push(customVal);

        //datalist.length就是
        for (var j = 0; j < dataList.length; j++) {
            var val = Math.random() * 1000;
            var val1 =echarts.number.round(val,0)
            dataList[j].push(val1);
            customVal.push(val1);
        }
    }

    function renderItem(params, api) {
        var xValue = api.value(0);
        var currentSeriesIndices = api.currentSeriesIndices();
        var barLayout = api.barLayout({
            barGap: '30%', barCategoryGap: '20%', count: currentSeriesIndices.length - 1
        });

        var points = [];
        for (var i = 0; i < currentSeriesIndices.length; i++) {
            var seriesIndex = currentSeriesIndices[i];
            if (seriesIndex !== params.seriesIndex) {
                var point = api.coord([xValue, api.value(seriesIndex)]);
                point[0] += barLayout[i - 1].offsetCenter;
                point[1] -= 20;
                points.push(point);
            }
        }
        var style = api.style({
            stroke: api.visual('color'),
            fill: null
        });

        return {
            type: 'polyline',
            shape: {
                points: points
            },
            style: style
        };
    }

    option = {
        tooltip: {
            trigger: 'axis'
        },
        legend: {
            data: legendData
        },
        dataZoom: [{
            type: 'slider',
            start: 50,
            end: 70
        }, {
            type: 'inside',
            start: 50,
            end: 70
        }],
        xAxis: {
            data: xAxisData,
            axisLabel: {
                interval: 0,
                formatter:function(value)
                {
                    debugger
                    var ret = "";//拼接加\n返回的类目项
                    var maxLength = 8;//每项显示文字个数
                    var valLength = value.length;//X轴类目项的文字个数
                    var rowN = Math.ceil(valLength / maxLength); //类目项需要换行的行数
                    if (rowN > 1)//如果类目项的文字大于3,
                    {
                        for (var i = 0; i < rowN; i++) {
                            var temp = "";//每次截取的字符串
                            var start = i * maxLength;//开始截取的位置
                            var end = start + maxLength;//结束截取的位置
                            //这里也可以加一个是否是最后一行的判断，但是不加也没有影响，那就不加吧
                            temp = value.substring(start, end) + "\n";
                            ret += temp; //凭借最终的字符串
                        }
                        return ret;
                    }
                    else {
                        return value;
                    }
                }
            }
        },
        grid: {
            left: '10%',
            bottom:'20%'
        },
        grid: {
            left: '10%',
            bottom:'25%'
        },
        yAxis: {},
        series: [{
            type: 'custom',
            name: '价格趋势',
            renderItem: renderItem,
            itemStyle: {
                borderWidth: 2
            },
            encode: {
                x: 0,
                y: encodeY
            },
            data: customData,
            z: 100
        }].concat(echarts.util.map(dataList, function (data, index) {
            return {
                type: 'bar',
                animation: false,
                name: legendData[index + 1],
                itemStyle: {
                    opacity: 0.5
                },
                data: data
            };
        }))
    };
    if (option && typeof option === "object") {
        myChart.setOption(option, true);
    }
</script>
</body>
</html>